<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>The Nexus:/Revenant Division</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;600;700&family=Share+Tech+Mono&family=IBM+Plex+Mono:wght@300;400;500&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg: #05010d;
      --fg: #e4f8ff;
      --neon-magenta: #ff1fb8;
      --neon-cyan: #3dfbff;
      --neon-orange: #ff8c33;
      --muted: rgba(228, 248, 255, 0.65);
      --panel: rgba(10, 14, 42, 0.8);
      --scanline: rgba(255, 255, 255, 0.04);
      --shadow: 0 0 20px rgba(61, 251, 255, 0.4);
      font-size: clamp(15px, 1.1vw, 18px);
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      background: var(--bg);
      color: var(--fg);
      font-family: 'IBM Plex Mono', monospace;
      overflow-x: hidden;
      position: relative;
    }

    body.signal-fade main {
      filter: blur(6px) saturate(0.5);
      opacity: 0.35;
      pointer-events: none;
    }

    body::before,
    body::after {
      content: "";
      position: fixed;
      inset: 0;
      pointer-events: none;
      z-index: -2;
    }

    body::before {
      background: radial-gradient(circle at top left, rgba(255, 31, 184, 0.23), transparent 45%),
                  radial-gradient(circle at bottom right, rgba(61, 251, 255, 0.16), transparent 40%),
                  radial-gradient(circle at 60% 40%, rgba(255, 140, 51, 0.18), transparent 45%);
      mix-blend-mode: screen;
    }

    body::after {
      background-image: repeating-linear-gradient(
        0deg,
        transparent,
        transparent 2px,
        var(--scanline) 2px,
        var(--scanline) 3px
      );
      animation: scanline 10s linear infinite;
    }

    body.signal-fade main {
      filter: blur(6px) saturate(0.5);
      opacity: 0.35;
      pointer-events: none;
    }

    body.signal-fade footer,
    body.signal-fade .audio-toggle {
      pointer-events: none;
      opacity: 0.3;
    }

    @keyframes scanline {
      from { transform: translateY(0); }
      to { transform: translateY(100%); }
    }

    #cyber-background {
      position: fixed;
      inset: 0;
      overflow: hidden;
      z-index: -1;
      pointer-events: none;
    }

    .cyber-orb {
      position: absolute;
      width: clamp(180px, 20vw, 280px);
      height: clamp(180px, 20vw, 280px);
      background: radial-gradient(circle, rgba(61, 251, 255, 0.18), rgba(255, 31, 184, 0));
      border: 1px solid rgba(61, 251, 255, 0.2);
      filter: blur(0.5px);
      animation: drift 18s linear infinite;
      mix-blend-mode: screen;
    }

    .cyber-orb:nth-child(1) { top: -5%; left: 5%; animation-duration: 26s; }
    .cyber-orb:nth-child(2) { top: 35%; right: -8%; animation-duration: 32s; }
    .cyber-orb:nth-child(3) { bottom: -10%; left: 10%; animation-duration: 22s; }

    @keyframes drift {
      0% { transform: translate3d(0, 0, 0) rotate(0deg); opacity: 0.45; }
      25% { transform: translate3d(40px, 60px, 0) rotate(12deg); opacity: 0.6; }
      50% { transform: translate3d(-30px, 120px, 0) rotate(22deg); opacity: 0.5; }
      75% { transform: translate3d(60px, -40px, 0) rotate(32deg); opacity: 0.7; }
      100% { transform: translate3d(0, 0, 0) rotate(0deg); opacity: 0.45; }
    }

    .cyber-stream {
      position: absolute;
      width: 140%;
      height: 2px;
      background: linear-gradient(90deg, transparent, rgba(61, 251, 255, 0.5), transparent);
      animation: stream 12s linear infinite;
      opacity: 0.5;
    }

    .cyber-stream:nth-child(4) { top: 20%; left: -20%; }
    .cyber-stream:nth-child(5) { top: 60%; left: -30%; animation-duration: 16s; }
    .cyber-stream:nth-child(6) { top: 85%; left: -10%; animation-duration: 10s; }

    @keyframes stream {
      0% { transform: translateX(0); opacity: 0; }
      20% { opacity: 0.55; }
      50% { opacity: 0.75; }
      100% { transform: translateX(40%); opacity: 0; }
    }

    .cyber-node {
      position: absolute;
      width: 6px;
      height: 6px;
      border-radius: 50%;
      background: var(--neon-magenta);
      box-shadow: 0 0 8px rgba(255, 31, 184, 0.8);
      animation: pulse-node 2.8s ease-in-out infinite;
    }

    .cyber-node:nth-child(7) { top: 15%; left: 45%; animation-delay: 0.4s; }
    .cyber-node:nth-child(8) { top: 55%; left: 25%; animation-delay: 1s; }
    .cyber-node:nth-child(9) { top: 75%; right: 15%; animation-delay: 1.8s; }

    @keyframes pulse-node {
      0%, 100% { transform: scale(1); opacity: 0.65; }
      50% { transform: scale(1.8); opacity: 1; }
    }

    main {
      position: relative;
      z-index: 1;
    }

    section {
      padding: 6rem clamp(1.5rem, 5vw, 8rem);
      position: relative;
    }

    .grid {
      display: grid;
      gap: clamp(1.5rem, 3vw, 3.5rem);
    }

    .hero {
      min-height: 100vh;
      display: grid;
      align-items: center;
      position: relative;
      overflow: hidden;
    }

    .hero::before {
      content: "";
      position: absolute;
      inset: 0;
      background: radial-gradient(circle at 20% 20%, rgba(255, 31, 184, 0.4), transparent 55%),
                  radial-gradient(circle at 80% 70%, rgba(61, 251, 255, 0.3), transparent 55%);
      filter: blur(40px);
      opacity: 0.7;
      animation: pulse 12s ease-in-out infinite;
      pointer-events: none;
    }

    @keyframes pulse {
      0%, 100% { transform: scale(1); opacity: 0.6; }
      50% { transform: scale(1.05); opacity: 0.8; }
    }

    h1, h2, h3 {
      font-family: 'Orbitron', sans-serif;
      letter-spacing: 0.18em;
      text-transform: uppercase;
    }

    h1 {
      font-size: clamp(2.8rem, 6vw, 5rem);
      margin: 0;
      line-height: 1.1;
      color: var(--fg);
      text-shadow: 0 0 18px rgba(255, 31, 184, 0.7), 0 0 30px rgba(61, 251, 255, 0.5);
    }

    h2 {
      font-size: clamp(1.5rem, 2.4vw, 2.5rem);
      margin-bottom: 1rem;
    }

    p {
      color: var(--muted);
      line-height: 1.7;
      max-width: 70ch;
    }

    .tagline {
      font-family: 'Share Tech Mono', monospace;
      text-transform: uppercase;
      letter-spacing: 0.5em;
      font-size: clamp(0.9rem, 1vw, 1.2rem);
      color: var(--neon-cyan);
      margin-bottom: 1.5rem;
      display: inline-block;
      position: relative;
    }

    .tagline::after {
      content: "";
      position: absolute;
      height: 2px;
      width: 80px;
      background: linear-gradient(90deg, var(--neon-cyan), transparent);
      right: -100px;
      top: 50%;
      transform: translateY(-50%);
    }

    .button {
      display: inline-flex;
      align-items: center;
      gap: 0.75rem;
      padding: 0.85rem 1.6rem;
      border: 1px solid var(--neon-magenta);
      background: rgba(255, 31, 184, 0.1);
      color: var(--fg);
      text-transform: uppercase;
      letter-spacing: 0.2em;
      font-family: 'Share Tech Mono', monospace;
      font-size: 0.85rem;
      cursor: pointer;
      transition: transform 0.3s ease, box-shadow 0.3s ease, border-color 0.3s;
      position: relative;
      overflow: hidden;
    }

    .button::before {
      content: "";
      position: absolute;
      inset: 0;
      background: linear-gradient(130deg, rgba(61, 251, 255, 0.4), transparent 50%);
      opacity: 0;
      transition: opacity 0.4s ease;
    }

    .button:hover {
      transform: translateY(-3px);
      box-shadow: 0 0 25px rgba(255, 31, 184, 0.3), 0 0 35px rgba(61, 251, 255, 0.3);
      border-color: var(--neon-cyan);
    }

    .button:hover::before {
      opacity: 1;
    }

    .panel {
      background: var(--panel);
      border: 1px solid rgba(61, 251, 255, 0.15);
      box-shadow: 0 0 20px rgba(255, 31, 184, 0.12), inset 0 0 30px rgba(61, 251, 255, 0.08);
      padding: clamp(1.5rem, 3vw, 2.5rem);
      position: relative;
      overflow: hidden;
    }

    .panel::before {
      content: "";
      position: absolute;
      inset: 0;
      background: linear-gradient(130deg, rgba(255, 31, 184, 0.08), transparent 40%);
      pointer-events: none;
    }

    .panel-title {
      display: flex;
      align-items: center;
      gap: 0.6rem;
      margin-bottom: 1rem;
      color: var(--neon-cyan);
      font-family: 'Share Tech Mono', monospace;
      letter-spacing: 0.3em;
      text-transform: uppercase;
      font-size: 0.9rem;
    }

    .panel-title::before {
      content: "";
      width: 45px;
      height: 1px;
      background: linear-gradient(90deg, var(--neon-cyan), transparent);
    }

    .lore-list {
      display: grid;
      gap: 1.5rem;
    }

    .lore-item {
      position: relative;
      padding-left: 2.5rem;
    }

    .lore-item::before {
      content: "◈";
      position: absolute;
      left: 0;
      color: var(--neon-magenta);
      text-shadow: 0 0 12px var(--neon-magenta);
      animation: float 4s ease-in-out infinite;
    }

    @keyframes float {
      0%, 100% { transform: translateY(-2px); }
      50% { transform: translateY(2px); }
    }

    .holo-billboard {
      position: relative;
      min-height: 320px;
      border: 1px solid rgba(61, 251, 255, 0.4);
      overflow: hidden;
      display: grid;
      place-items: center;
      color: var(--fg);
      text-align: center;
      font-family: 'Share Tech Mono', monospace;
      letter-spacing: 0.2em;
      text-transform: uppercase;
    }

    .holo-billboard::before {
      content: "";
      position: absolute;
      inset: -40%;
      background: conic-gradient(from 0deg, rgba(61, 251, 255, 0.2), rgba(255, 31, 184, 0.2), rgba(61, 251, 255, 0.2));
      filter: blur(45px);
      animation: swirl 22s linear infinite;
    }

    @keyframes swirl {
      to { transform: rotate(360deg); }
    }

    .holo-billboard .city {
      position: relative;
      z-index: 1;
      font-size: clamp(1.2rem, 2vw, 2rem);
      line-height: 1.6;
      text-shadow: 0 0 20px rgba(61, 251, 255, 0.8);
    }

    .wave {
      position: relative;
      overflow: hidden;
      padding-bottom: clamp(2rem, 6vw, 4rem);
      border-bottom: 1px solid rgba(255, 31, 184, 0.25);
    }

    .wave::after {
      content: "";
      position: absolute;
      left: 0;
      bottom: 0;
      width: 100%;
      height: 120px;
      background: linear-gradient(0deg, rgba(5, 1, 13, 1), rgba(5, 1, 13, 0));
      pointer-events: none;
    }

    .choices {
      display: grid;
      gap: 1.2rem;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      margin-top: 1.5rem;
    }

    .choice-card {
      border: 1px solid rgba(61, 251, 255, 0.3);
      padding: 1.25rem;
      background: rgba(6, 10, 36, 0.85);
      cursor: pointer;
      transition: transform 0.3s ease, border-color 0.3s ease, box-shadow 0.3s ease;
      position: relative;
      min-height: 180px;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
    }

    .choice-card:hover {
      transform: translateY(-6px);
      border-color: var(--neon-magenta);
      box-shadow: 0 0 25px rgba(255, 31, 184, 0.25);
    }

    .choice-card.active {
      border-color: var(--neon-cyan);
      box-shadow: 0 0 25px rgba(61, 251, 255, 0.25);
    }

    .choice-title {
      font-family: 'Orbitron', sans-serif;
      letter-spacing: 0.15em;
      color: var(--neon-cyan);
      font-size: 1rem;
    }

    .choice-desc {
      color: var(--muted);
      font-size: 0.95rem;
      margin-top: 0.75rem;
      line-height: 1.6;
    }

    .step-label {
      display: inline-flex;
      align-items: center;
      gap: 0.6rem;
      color: var(--neon-orange);
      font-family: 'Share Tech Mono', monospace;
      letter-spacing: 0.35em;
      text-transform: uppercase;
      font-size: 0.82rem;
    }

    .scanline-panel {
      position: relative;
      overflow: hidden;
    }

    .scanline-panel::after {
      content: "";
      position: absolute;
      inset: 0;
      background: repeating-linear-gradient(
        0deg,
        rgba(255, 31, 184, 0.04) 0px,
        rgba(255, 31, 184, 0.04) 2px,
        transparent 2px,
        transparent 4px
      );
      mix-blend-mode: screen;
      pointer-events: none;
    }

    .dossier {
      display: grid;
      gap: 1rem;
    }

    .dossier-line {
      display: flex;
      justify-content: space-between;
      align-items: center;
      border-bottom: 1px dashed rgba(61, 251, 255, 0.2);
      padding: 0.6rem 0;
      font-size: 0.95rem;
      letter-spacing: 0.2em;
      text-transform: uppercase;
    }

    .dossier-line strong {
      color: var(--neon-cyan);
      font-weight: 500;
    }

    .assignment {
      font-family: 'Orbitron', sans-serif;
      font-size: clamp(1.5rem, 3vw, 2.6rem);
      letter-spacing: 0.3em;
      color: var(--neon-magenta);
      text-align: center;
      margin: 2rem 0 1rem;
      text-shadow: 0 0 20px rgba(255, 31, 184, 0.65);
    }

    .assignment-desc {
      text-align: center;
      margin-bottom: 2rem;
      color: var(--muted);
      font-size: 1rem;
      line-height: 1.7;
    }

    .badge {
      margin: 0 auto;
      border: 1px solid rgba(61, 251, 255, 0.35);
      border-radius: 12px;
      padding: 1.5rem;
      max-width: 380px;
      text-align: center;
      background: rgba(8, 14, 38, 0.85);
      box-shadow: 0 0 35px rgba(61, 251, 255, 0.18), inset 0 0 32px rgba(255, 31, 184, 0.08);
    }

    .badge h3 {
      letter-spacing: 0.25em;
      font-size: 1rem;
      margin-bottom: 0.6rem;
      color: var(--neon-cyan);
    }

    .badge .sigil {
      font-size: 2.4rem;
      letter-spacing: 0.4em;
      text-shadow: 0 0 25px rgba(255, 31, 184, 0.6);
      margin-bottom: 0.6rem;
    }

    .badge p {
      font-size: 0.85rem;
      text-transform: uppercase;
      letter-spacing: 0.2em;
      color: rgba(228, 248, 255, 0.75);
    }

    .terminal {
      background: rgba(3, 5, 18, 0.85);
      border: 1px solid rgba(255, 31, 184, 0.25);
      padding: 2rem;
      font-family: 'Share Tech Mono', monospace;
      color: rgba(61, 251, 255, 0.85);
      position: relative;
      overflow: hidden;
    }

    .terminal::before {
      content: "";
      position: absolute;
      inset: 0;
      background: linear-gradient(180deg, rgba(61, 251, 255, 0.08), transparent 65%);
      pointer-events: none;
    }

    .terminal-line {
      display: block;
      margin-bottom: 0.6rem;
      text-transform: uppercase;
      letter-spacing: 0.18em;
    }

    .terminal-inputs {
      display: grid;
      gap: 1rem;
      margin: 1.5rem 0;
    }

    .terminal-field {
      display: grid;
      gap: 0.5rem;
    }

    label {
      font-size: 0.75rem;
      letter-spacing: 0.3em;
      text-transform: uppercase;
      color: rgba(61, 251, 255, 0.8);
    }

    input, textarea {
      background: rgba(0, 4, 15, 0.85);
      border: 1px solid rgba(61, 251, 255, 0.3);
      color: var(--fg);
      padding: 0.6rem;
      font-family: 'IBM Plex Mono', monospace;
      letter-spacing: 0.08em;
      outline: none;
      transition: border-color 0.3s ease, box-shadow 0.3s ease;
    }

    input:focus, textarea:focus {
      border-color: var(--neon-magenta);
      box-shadow: 0 0 15px rgba(255, 31, 184, 0.35);
    }

    textarea {
      min-height: 110px;
      resize: vertical;
    }

    .signal-grid {
      display: grid;
      gap: 1.5rem;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
    }

    .signal-card {
      padding: 1rem;
      border: 1px solid rgba(255, 31, 184, 0.3);
      background: rgba(8, 10, 32, 0.8);
      position: relative;
      overflow: hidden;
      cursor: pointer;
      transition: transform 0.3s ease, border-color 0.3s ease;
    }

    .signal-card:hover {
      transform: translateY(-8px);
      border-color: var(--neon-cyan);
    }

    .signal-card::before {
      content: "";
      position: absolute;
      inset: -20%;
      background: linear-gradient(130deg, rgba(255, 31, 184, 0.3), transparent 50%);
      opacity: 0.4;
      filter: blur(25px);
    }

    .signal-card h4 {
      font-family: 'Orbitron', sans-serif;
      letter-spacing: 0.18em;
      color: var(--neon-cyan);
      margin-bottom: 0.6rem;
      text-transform: uppercase;
    }

    .signal-card p {
      font-size: 0.9rem;
      color: rgba(228, 248, 255, 0.75);
      line-height: 1.6;
    }

    .map-wrap {
      display: grid;
      gap: clamp(1.5rem, 4vw, 3.5rem);
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      align-items: stretch;
    }

    .map-grid {
      position: relative;
      background: rgba(6, 12, 34, 0.85);
      border: 1px solid rgba(61, 251, 255, 0.25);
      box-shadow: inset 0 0 40px rgba(61, 251, 255, 0.12), 0 0 40px rgba(255, 31, 184, 0.15);
      overflow: hidden;
      min-height: 320px;
    }

    .map-grid::before {
      content: "";
      position: absolute;
      inset: 0;
      background: linear-gradient(90deg, rgba(255, 31, 184, 0.05) 1px, transparent 1px),
                  linear-gradient(0deg, rgba(61, 251, 255, 0.05) 1px, transparent 1px);
      background-size: 70px 70px;
      opacity: 0.4;
      mix-blend-mode: lighten;
    }

    .city-map {
      position: relative;
      width: 100%;
      height: auto;
      filter: drop-shadow(0 0 12px rgba(61, 251, 255, 0.35));
    }

    .district {
      fill: rgba(61, 251, 255, 0.18);
      stroke: rgba(255, 31, 184, 0.5);
      stroke-width: 2;
      transition: fill 0.3s ease, stroke 0.3s ease, filter 0.3s ease;
      cursor: pointer;
      outline: none;
    }

    .district:hover,
    .district:focus,
    .district.active {
      fill: rgba(255, 31, 184, 0.28);
      stroke: rgba(61, 251, 255, 0.8);
      filter: drop-shadow(0 0 18px rgba(61, 251, 255, 0.45));
    }

    .map-pulse {
      fill: none;
      stroke: rgba(61, 251, 255, 0.3);
      stroke-dasharray: 6;
      animation: orbit 14s linear infinite;
    }

    @keyframes orbit {
      to { stroke-dashoffset: -120; }
    }

    .territory-panel {
      background: rgba(10, 15, 40, 0.85);
      border: 1px solid rgba(255, 31, 184, 0.25);
      padding: clamp(1.5rem, 3vw, 2.4rem);
      box-shadow: inset 0 0 32px rgba(255, 31, 184, 0.12), 0 0 24px rgba(61, 251, 255, 0.18);
      display: grid;
      gap: 1rem;
    }

    .territory-output h3 {
      font-family: 'Orbitron', sans-serif;
      letter-spacing: 0.3em;
      font-size: clamp(1.1rem, 1.8vw, 1.6rem);
      color: var(--neon-cyan);
      margin: 0;
    }

    .territory-output p {
      color: rgba(228, 248, 255, 0.7);
      line-height: 1.7;
    }

    .territory-meta {
      display: grid;
      gap: 0.8rem;
    }

    .meta-line {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 0.85rem;
      letter-spacing: 0.2em;
      text-transform: uppercase;
      color: rgba(228, 248, 255, 0.7);
      border-bottom: 1px dashed rgba(61, 251, 255, 0.2);
      padding-bottom: 0.5rem;
    }

    .meta-line strong {
      color: var(--neon-magenta);
      font-weight: 500;
    }

    .rivalry {
      display: grid;
      gap: 0.6rem;
    }

    .rivalry strong {
      font-size: 0.78rem;
      letter-spacing: 0.28em;
      text-transform: uppercase;
      color: rgba(255, 140, 51, 0.85);
    }

    .rival-tags {
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
    }

    .rival-tag {
      border: 1px solid rgba(255, 31, 184, 0.4);
      padding: 0.4rem 0.9rem;
      font-size: 0.75rem;
      letter-spacing: 0.22em;
      text-transform: uppercase;
      color: rgba(228, 248, 255, 0.8);
      background: rgba(255, 31, 184, 0.12);
    }

    .map-notes {
      font-size: 0.75rem;
      letter-spacing: 0.24em;
      text-transform: uppercase;
      color: rgba(228, 248, 255, 0.5);
    }

    .exit {
      text-align: center;
    }

    .exit h2 {
      text-shadow: 0 0 20px rgba(61, 251, 255, 0.5);
    }

    .exit-countdown {
      font-size: clamp(2.4rem, 5vw, 3.8rem);
      letter-spacing: 0.35em;
      font-family: 'Orbitron', sans-serif;
      color: var(--neon-orange);
      text-shadow: 0 0 20px rgba(255, 140, 51, 0.6);
      margin: 1.5rem 0;
    }

    footer {
      padding: 2rem clamp(1.5rem, 5vw, 8rem);
      color: rgba(228, 248, 255, 0.4);
      font-size: 0.75rem;
      letter-spacing: 0.3em;
      text-transform: uppercase;
      font-family: 'Share Tech Mono', monospace;
      border-top: 1px solid rgba(61, 251, 255, 0.2);
      text-align: center;
    }

    /* Boot overlay */
    #boot-overlay {
      position: fixed;
      inset: 0;
      background: radial-gradient(circle at center, rgba(0, 255, 234, 0.25), rgba(3, 5, 20, 0.95));
      backdrop-filter: blur(6px);
      display: grid;
      place-items: center;
      z-index: 10;
      transition: opacity 0.8s ease;
    }

    #boot-overlay.hidden {
      opacity: 0;
      pointer-events: none;
    }

    .boot-sequence {
      max-width: 520px;
      text-align: center;
      padding: 3rem;
      border: 1px solid rgba(61, 251, 255, 0.4);
      background: rgba(2, 6, 18, 0.85);
      box-shadow: 0 0 35px rgba(61, 251, 255, 0.25), inset 0 0 50px rgba(255, 31, 184, 0.08);
      position: relative;
      overflow: hidden;
    }

    .boot-sequence::after {
      content: "";
      position: absolute;
      inset: 0;
      background: linear-gradient(130deg, rgba(255, 31, 184, 0.15), transparent 55%);
      mix-blend-mode: screen;
      pointer-events: none;
    }

    .background-check {
      margin-top: 2rem;
      display: grid;
      gap: 1.1rem;
      text-align: left;
    }

    .check-group {
      display: grid;
      gap: 0.5rem;
    }

    .check-options {
      display: flex;
      flex-wrap: wrap;
      gap: 0.6rem;
    }

    .check-tag {
      border: 1px solid rgba(61, 251, 255, 0.35);
      padding: 0.45rem 0.85rem;
      font-size: 0.75rem;
      letter-spacing: 0.22em;
      text-transform: uppercase;
      cursor: pointer;
      transition: border-color 0.3s ease, background 0.3s ease, color 0.3s ease;
      background: rgba(6, 12, 32, 0.7);
      color: rgba(228, 248, 255, 0.75);
    }

    .check-tag.active {
      border-color: var(--neon-magenta);
      background: rgba(255, 31, 184, 0.15);
      color: var(--fg);
    }

    .background-check input,
    .background-check select {
      background: rgba(3, 5, 18, 0.85);
      border: 1px solid rgba(61, 251, 255, 0.4);
      color: var(--fg);
      padding: 0.6rem;
      font-family: 'IBM Plex Mono', monospace;
      letter-spacing: 0.12em;
      text-transform: uppercase;
    }

    .background-check input:focus,
    .background-check select:focus {
      border-color: var(--neon-magenta);
      box-shadow: 0 0 14px rgba(255, 31, 184, 0.4);
      outline: none;
    }

    .check-status {
      min-height: 1rem;
      font-size: 0.75rem;
      letter-spacing: 0.28em;
      text-transform: uppercase;
      color: rgba(228, 248, 255, 0.6);
      text-align: center;
    }

    .boot-line {
      font-family: 'Share Tech Mono', monospace;
      letter-spacing: 0.35em;
      text-transform: uppercase;
      font-size: 0.82rem;
      color: rgba(228, 248, 255, 0.7);
      opacity: 0;
      transform: translateY(10px);
      transition: opacity 0.6s ease, transform 0.6s ease;
      margin-bottom: 1.1rem;
    }

    .boot-line.visible {
      opacity: 1;
      transform: translateY(0);
    }

    .audio-toggle {
      position: fixed;
      right: 1.5rem;
      bottom: 1.5rem;
      z-index: 5;
      background: rgba(8, 12, 40, 0.8);
      border: 1px solid rgba(61, 251, 255, 0.4);
      color: var(--neon-cyan);
      padding: 0.7rem 1rem;
      letter-spacing: 0.3em;
      text-transform: uppercase;
      font-size: 0.75rem;
      cursor: pointer;
      font-family: 'Share Tech Mono', monospace;
      display: inline-flex;
      align-items: center;
      gap: 0.6rem;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }

    .audio-toggle:hover {
      transform: translateY(-3px);
      box-shadow: 0 0 20px rgba(61, 251, 255, 0.25);
    }

    .ambient {
      display: none;
    }

    .glitch {
      position: relative;
      display: inline-block;
    }

    .glitch::before,
    .glitch::after {
      content: attr(data-text);
      position: absolute;
      left: 0;
      top: 0;
      opacity: 0.7;
      clip-path: inset(0 0 0 0);
    }

    .glitch::before {
      color: var(--neon-magenta);
      transform: translate(2px, -2px);
      mix-blend-mode: screen;
    }

    .glitch::after {
      color: var(--neon-cyan);
      transform: translate(-2px, 2px);
      mix-blend-mode: screen;
    }

    .glitch-anim::before {
      animation: glitch 2s infinite linear alternate-reverse;
    }

    .glitch-anim::after {
      animation: glitch 2.4s infinite linear alternate;
    }

    @keyframes glitch {
      0% { clip-path: inset(10% 0 85% 0); transform: translate(-2px, -1px); }
      20% { clip-path: inset(40% 0 40% 0); transform: translate(2px, 1px); }
      40% { clip-path: inset(80% 0 5% 0); transform: translate(-1px, 2px); }
      60% { clip-path: inset(10% 0 50% 0); transform: translate(1px, -2px); }
      80% { clip-path: inset(20% 0 70% 0); transform: translate(-1px, 1px); }
      100% { clip-path: inset(5% 0 80% 0); transform: translate(2px, 0); }
    }

    .secret-modal {
      position: fixed;
      inset: 0;
      background: rgba(5, 0, 12, 0.94);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 20;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.5s ease;
    }

    .secret-modal.visible {
      opacity: 1;
      pointer-events: all;
    }

    .secret-content {
      border: 1px solid rgba(255, 31, 184, 0.4);
      padding: 3rem clamp(1.5rem, 4vw, 3rem);
      text-align: center;
      max-width: 520px;
      background: rgba(5, 7, 20, 0.95);
      position: relative;
      overflow: hidden;
    }

    .secret-content::before {
      content: "";
      position: absolute;
      inset: 0;
      background: linear-gradient(130deg, rgba(255, 31, 184, 0.2), transparent 60%);
      pointer-events: none;
    }

    .secret-content h3 {
      font-size: 1.1rem;
      letter-spacing: 0.3em;
      text-transform: uppercase;
      color: var(--neon-cyan);
    }

    .secret-content p {
      margin: 1.25rem 0 0;
      color: rgba(228, 248, 255, 0.7);
      line-height: 1.8;
    }

    /* Responsive adjustments */
    @media (max-width: 720px) {
      .hero {
        padding-top: 6rem;
        padding-bottom: 6rem;
      }

      h1 {
        letter-spacing: 0.12em;
      }

      .tagline {
        letter-spacing: 0.35em;
      }

      .assignment {
        letter-spacing: 0.15em;
      }

      .audio-toggle {
        right: 1rem;
        bottom: 1rem;
      }

      .boot-sequence {
        padding: 2.4rem 1.6rem;
        letter-spacing: 0.2em;
      }

      .wave::after {
        height: 80px;
      }
    }
  </style>
</head>
<body>
  <div id="cyber-background">
    <div class="cyber-orb"></div>
    <div class="cyber-orb"></div>
    <div class="cyber-orb"></div>
    <div class="cyber-stream"></div>
    <div class="cyber-stream"></div>
    <div class="cyber-stream"></div>
    <div class="cyber-node"></div>
    <div class="cyber-node"></div>
    <div class="cyber-node"></div>
  </div>
  <div id="boot-overlay">
    <div class="boot-sequence">
      <span class="boot-line" data-delay="0">INITIALIZING INTERCEPT ARRAY...</span>
      <span class="boot-line" data-delay="700">NEURAL FILTERS CALIBRATED.</span>
      <span class="boot-line" data-delay="1400">PHANTOM ROUTERS: ONLINE.</span>
      <span class="boot-line" data-delay="2100">TRACE CLEANSE: 99.7% COMPLETE.</span>
      <span class="boot-line" data-delay="2800">ACCESS NODE: NEXUS://REVENANT-DIVISION</span>
      <span class="boot-line" data-delay="3500">STATUS: <span class="glitch glitch-anim" data-text="ACCESS GRANTED">ACCESS GRANTED</span></span>
      <form class="background-check" id="background-check">
        <div class="check-group">
          <label for="check-alias">Runner Alias</label>
          <input type="text" id="check-alias" maxlength="18" placeholder="Enter alias" required>
        </div>
        <div class="check-group">
          <label for="check-code">Cipher Clearance</label>
          <input type="text" id="check-code" placeholder="Specter Phrase" required>
        </div>
        <div class="check-group">
          <span style="font-size:0.72rem; letter-spacing:0.28em; text-transform:uppercase; color:rgba(228,248,255,0.7);">Declare Allegiance</span>
          <div class="check-options" id="allegiance-options">
            <span class="check-tag" data-tag="rebel">Rebel Cell</span>
            <span class="check-tag" data-tag="merc">Mercenary</span>
            <span class="check-tag" data-tag="corp">Corp Sympathizer</span>
          </div>
        </div>
        <button class="button" type="submit" id="validate-access">Validate Identity</button>
        <span class="check-status" id="check-status"></span>
      </form>
      <button class="button" id="boot-enter" style="margin-top:2rem; display:none;">ENTER THE NEXUS</button>
    </div>
  </div>

  <audio id="ambient" class="ambient" loop></audio>
  <button class="audio-toggle" id="audio-toggle">AUDIO: OFF</button>

  <main id="content">
    <section class="hero">
      <div class="grid" style="grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); align-items: center; gap: clamp(2rem, 5vw, 4rem);">
        <div style="z-index:1;">
          <span class="tagline">The Nexus:/Revenant Division</span>
          <h1 class="glitch glitch-anim" data-text="Recruitment Uplink">Recruitment Uplink</h1>
          <p style="margin:1.8rem 0 0; max-width:48ch;">
            You pierced the blackout veil and found the Revenant Division’s infiltration node. Every packet you send is shadowed, every biometric you provide is ghosted. This is the only gateway that matters.
          </p>
          <div style="margin-top:2.5rem; display:flex; flex-wrap:wrap; gap:1rem;">
            <a class="button" href="#profiling">Initiate Profiling</a>
            <a class="button" href="#manifesto" style="border-color:rgba(61,251,255,0.6);">Read the Dossier</a>
          </div>
        </div>
        <div class="panel holo-billboard">
          <div class="city">
            NeoCity // Sector 7G<br>
            Rainfall: Constant<br>
            Surveillance: 98.4%<br>
            Revenant Signal Strength: MAX
          </div>
        </div>
      </div>
    </section>

    <section id="manifesto" class="wave">
      <div class="grid" style="grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); align-items: flex-start;">
        <div class="panel scanline-panel">
          <span class="panel-title">Gang Manifesto</span>
          <h2>Rise Beyond Flesh.</h2>
          <p>
            The Revenant Division wages war in electric whispers. We hijack the feeds, fracture the megacorps, rewrite the code that chains the city to a myth of control. Recruits who breach this uplink become more than muscle, more than data—they become revenants.
          </p>
          <div class="lore-list" style="margin-top:1.5rem;">
            <div class="lore-item">
              <strong>01: Ghost Signal</strong><br>
              Our bunkers exist between heartbeats. Interference shields cloak our transmissions—each member emits a synthetic identity swarm to fracture traces.
            </div>
            <div class="lore-item">
              <strong>02: Chrome Pact</strong><br>
              Members install the pact: encrypted implants feeding real-time intel to the collective. We feel each other’s pulse and pivot as one.
            </div>
            <div class="lore-item">
              <strong>03: Neon Doctrine</strong><br>
              We weaponize aesthetics. Street projections, glitched propaganda, viral myth-makers. The city will chant our name before it notices the collapse.
            </div>
          </div>
        </div>
        <div class="panel">
          <span class="panel-title">Operation Feed</span>
          <h2>Tonight’s Broadcast</h2>
          <p>
            “Silicon never forgets” – recorded from a corporate whisper. We traced it, inverted it, returned it through every broken AR pane in Sector Nine. The boardrooms are panicking. Old blood is spilling. Your arrival is the next spike in the waveform.
          </p>
          <div class="panel" style="margin-top:2rem; background:rgba(6,10,36,0.8); border-color:rgba(255,31,184,0.25);">
            <span class="panel-title">Encrypted Intel</span>
            <p style="color:rgba(228,248,255,0.7);">
              Signal fragment recovered: <em>[Sig: 88X-NOCT-REIGN]</em><br>
              <strong>Decoded</strong>: “Revenant cells blending with railcloud traffic. Tracking impossible.”<br>
              <strong>Directive</strong>: Maintain myth, recruit only the haunted.
            </p>
          </div>
        </div>
      </div>
    </section>

    <section id="profiling" class="wave">
      <span class="step-label">Phase 1 // Initiate Profiling</span>
      <h2>Prove Your Worth</h2>
      <p>
        Select your instinct. The uplink monitors micro-twitch responses and cross-references them with our mythic archetypes. Choose with intent; the Division abhors hesitation.
      </p>

      <div class="choices" data-step="instinct">
        <div class="choice-card" data-id="alpha">
          <div>
            <div class="choice-title">Alpha</div>
            <div class="choice-desc">
              You destabilize choke points and ignite citywide diversions. Adrenaline is your currency.
            </div>
          </div>
          <span style="color:var(--neon-orange); letter-spacing:0.25em; font-size:0.75rem;">Signal Index: 77.2</span>
        </div>
        <div class="choice-card" data-id="oracle">
          <div>
            <div class="choice-title">Oracle</div>
            <div class="choice-desc">
              You read market fissures and predict when drones blink. You are the whisper behind the curtain.
            </div>
          </div>
          <span style="color:var(--neon-orange); letter-spacing:0.25em; font-size:0.75rem;">Signal Index: 88.4</span>
        </div>
        <div class="choice-card" data-id="specter">
          <div>
            <div class="choice-title">Specter</div>
            <div class="choice-desc">
              You move unseen, duplicating your echo across cameras. Silence obeys you.
            </div>
          </div>
          <span style="color:var(--neon-orange); letter-spacing:0.25em; font-size:0.75rem;">Signal Index: 92.6</span>
        </div>
        <div class="choice-card" data-id="breaker">
          <div>
            <div class="choice-title">Breaker</div>
            <div class="choice-desc">
              Data vaults bend when you exhale. Firewalls melt into your palms. Circuits beg forgiveness.
            </div>
          </div>
          <span style="color:var(--neon-orange); letter-spacing:0.25em; font-size:0.75rem;">Signal Index: 84.9</span>
        </div>
      </div>

      <div style="margin-top:3rem;">
        <span class="step-label">Phase 2 // Augment Selection</span>
        <div class="choices" data-step="augment">
          <div class="choice-card" data-id="drone-swarm">
            <div>
              <div class="choice-title">Drone Swarm</div>
              <div class="choice-desc">
                Micro-drones mesh into your blindspots, feeding tactical overlays and spectrum scans.
              </div>
            </div>
            <span style="color:var(--neon-cyan); letter-spacing:0.2em; font-size:0.75rem;">Telemetry Locked</span>
          </div>
          <div class="choice-card" data-id="dream-splice">
            <div>
              <div class="choice-title">Dream Splice</div>
              <div class="choice-desc">
                Hijack corporate executives mid-sleep and puppeteer their decisions at dawn.
              </div>
            </div>
            <span style="color:var(--neon-cyan); letter-spacing:0.2em; font-size:0.75rem;">Psych Index: 91</span>
          </div>
          <div class="choice-card" data-id="phase-shift">
            <div>
              <div class="choice-title">Phase Shift</div>
              <div class="choice-desc">
                Temporarily desync from city time. Cameras record static while you breach.
              </div>
            </div>
            <span style="color:var(--neon-cyan); letter-spacing:0.2em; font-size:0.75rem;">Temporal Drift</span>
          </div>
        </div>
      </div>

      <div style="margin-top:3rem;">
        <span class="step-label">Phase 3 // Allegiance Pulse</span>
        <div class="choices" data-step="allegiance">
          <div class="choice-card" data-id="chaos">
            <div>
              <div class="choice-title">Entropy Doctrine</div>
              <div class="choice-desc">
                Collapse the corp grids. Let the streets scrawl new law in electric ink.
              </div>
            </div>
            <span style="color:var(--neon-magenta); letter-spacing:0.2em; font-size:0.75rem;">Entropy +12</span>
          </div>
          <div class="choice-card" data-id="balance">
            <div>
              <div class="choice-title">Axis Directive</div>
              <div class="choice-desc">
                Redistribute power. Re-route resources to the shadow commons. Keep equilibrium breathing.
              </div>
            </div>
            <span style="color:var(--neon-magenta); letter-spacing:0.2em; font-size:0.75rem;">Entropy +03</span>
          </div>
          <div class="choice-card" data-id="revenge">
            <div>
              <div class="choice-title">Blood Ledger</div>
              <div class="choice-desc">
                Every megacorp sin will be answered. Names engraved in chromium debt.
              </div>
            </div>
            <span style="color:var(--neon-magenta); letter-spacing:0.2em; font-size:0.75rem;">Entropy +20</span>
          </div>
        </div>
      </div>

      <div style="display:flex; flex-wrap:wrap; gap:1rem; margin-top:3rem;">
        <button class="button" id="analyze">Analyze Profile</button>
        <span id="analysis-status" style="align-self:center; letter-spacing:0.3em; font-size:0.75rem; color:rgba(228,248,255,0.6);"></span>
      </div>
    </section>

    <section class="wave">
      <div class="panel scanline-panel">
        <span class="panel-title">Role Assignment</span>
        <div class="assignment glitch glitch-anim" data-text="Awaiting Signal">Awaiting Signal</div>
        <p class="assignment-desc">
          Your dossier is rendering in real time. Revenant analysts ride the bandwidth like feral ghosts. Stay focused.
        </p>
        <div class="badge">
          <h3>Revenant Sigil</h3>
          <div class="sigil" id="sigil">— — —</div>
          <p id="badge-text">Awaiting biosignature sync.</p>
        </div>

        <div class="panel" style="margin-top:2.5rem; background:rgba(10,14,42,0.75);">
          <span class="panel-title">Encrypted Dossier</span>
          <div class="dossier">
            <div class="dossier-line"><strong>Callsign</strong><span id="res-callsign">Pending</span></div>
            <div class="dossier-line"><strong>Skill Envelope</strong><span id="res-skill">Null</span></div>
            <div class="dossier-line"><strong>Loyalty Curve</strong><span id="res-loyalty">Calculating...</span></div>
            <div class="dossier-line"><strong>Risk Quotient</strong><span id="res-risk">/</span></div>
            <div class="dossier-line"><strong>Directive</strong><span id="res-directive">Standby</span></div>
          </div>
        </div>
      </div>
    </section>

    <section class="wave">
      <span class="step-label">Phase 4 // Submission Uplink</span>
      <h2>Transmit Your Ghost Data</h2>
      <div class="terminal">
        <span class="terminal-line">> establishing handshake...</span>
        <span class="terminal-line">> encryption key spool: [ █ █ █ █ █ ]</span>
        <form id="uplink-form">
          <div class="terminal-inputs">
            <div class="terminal-field">
              <label for="name">Biometric Alias</label>
              <input type="text" id="name" name="name" placeholder="Enter alias" required>
            </div>
            <div class="terminal-field">
              <label for="codename">Preferred Callsign</label>
              <input type="text" id="codename" name="codename" placeholder="e.g. IRON PHANTOM" required>
            </div>
            <div class="terminal-field">
              <label for="specialty">Primary Specialty</label>
              <input type="text" id="specialty" name="specialty" placeholder="Signal Hijack / Field Ops / etc">
            </div>
            <div class="terminal-field">
              <label for="motivation">Motivation Vector</label>
              <textarea id="motivation" name="motivation" placeholder="Deliver your origin myth."></textarea>
            </div>
          </div>
          <button class="button" type="submit">Send Packet</button>
        </form>
        <span class="terminal-line" id="uplink-status"></span>
      </div>
    </section>

    <section class="wave">
      <span class="step-label">Phase 5 // Signal Board</span>
      <h2>Holographic Briefings</h2>
      <div class="signal-grid">
        <div class="signal-card">
          <h4>Sector Echo-13</h4>
          <p>Railcloud sabotage scheduled. Need a drone pilot to blend with the maglev current. Reward: hidden chipset.</p>
        </div>
        <div class="signal-card">
          <h4>Mirage Theater</h4>
          <p>Projection takeover in 4 minutes. Artists needed to weave revenant sigils through corp propaganda.</p>
        </div>
        <div class="signal-card">
          <h4>Wiresong</h4>
          <p>Neural chorus seeking spectral voice to harmonize with city drones. Must sustain 180 bpm heartbeat.</p>
        </div>
        <div class="signal-card">
          <h4>Graffiti Pulse</h4>
          <p>AR taggers needed in old industrial block. Paint with photon dust, broadcast our creed in ten languages.</p>
        </div>
      </div>
    </section>

    <section id="territories" class="wave">
      <span class="step-label">Phase 6 // Territorial Intelligence</span>
      <h2>NeoCity Control Map</h2>
      <p>
        Observe NeoCity’s fractured dominion. Districts shimmer with different creeds, rivalries pulse beneath the pavement. Hover a sector to decrypt who commands it—and who they hunt.
      </p>
      <div class="map-wrap">
        <div class="map-grid">
          <svg class="city-map" viewBox="0 0 600 420" role="img" aria-labelledby="map-title">
            <title id="map-title">NeoCity Territory Allocation</title>
            <defs>
              <linearGradient id="district-glow" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" stop-color="rgba(61, 251, 255, 0.3)" />
                <stop offset="100%" stop-color="rgba(255, 31, 184, 0.28)" />
              </linearGradient>
            </defs>
            <polygon class="district" tabindex="0" data-gang="revenant" points="95,110 230,70 285,135 245,220 130,210" />
            <polygon class="district" tabindex="0" data-gang="chrome" points="280,80 420,60 470,150 360,210 290,170" />
            <polygon class="district" tabindex="0" data-gang="azure" points="150,230 260,230 300,315 210,355 130,310" />
            <polygon class="district" tabindex="0" data-gang="wraith" points="315,240 420,220 505,260 460,330 360,320" />
            <polygon class="district" tabindex="0" data-gang="lotus" points="70,240 125,260 150,335 90,360 40,300" />
            <circle class="map-pulse" cx="300" cy="200" r="160" />
          </svg>
        </div>
        <div class="territory-panel">
          <span class="panel-title">Encrypted Territory Feed</span>
          <div class="territory-output">
            <h3 id="territory-gang">Revenant Division</h3>
            <p id="territory-desc">Signal uplinks woven through the old transit spires. Revenants hijack surveillance beams and rewrite the city’s memory nightly.</p>
          </div>
          <div class="territory-meta">
            <div class="meta-line"><strong>Sector</strong><span id="territory-zone">Sector 7G</span></div>
            <div class="meta-line"><strong>Specialty</strong><span id="territory-specialty">Signal Infiltration</span></div>
          </div>
          <div class="rivalry">
            <strong>Rivals</strong>
            <div class="rival-tags" id="territory-rivals">
              <span class="rival-tag">Chrome Syndicate</span>
            </div>
          </div>
          <div class="map-notes">
            Data refreshed every 44 minutes. Spikes indicate active turf conflict.
          </div>
        </div>
      </div>
    </section>

    <section class="wave exit">
      <h2>Exit Protocol Engaged</h2>
      <div class="exit-countdown" id="exit-countdown">00:45</div>
      <p>
        The portal will self-scrub in 45 seconds. If you need another glimpse, trigger the override by typing <strong>GLITCH</strong>. Otherwise, sever your connection. Revenants move in silence.
      </p>
      <div style="margin-top:2rem;">
        <button class="button" id="reset-portal">Reboot Portal</button>
      </div>
    </section>
  </main>

  <footer>
    Revenant Division / NeoCity / Signal Auth 7G-Σ. | Fabricated entirely via AI directives. No backend. No traces.
  </footer>

  <div class="secret-modal" id="secret-modal">
    <div class="secret-content">
      <h3>Ghost Channel Unlocked</h3>
      <p>
        You cracked the GLITCH cipher. Revenant archives whisper: <em>“When iron rains, meet under the fractured billboard. Bring no shadows.”</em> This knowledge is yours—use it to reshape the neon tides.
      </p>
      <div style="margin-top:2rem;">
        <button class="button" id="close-secret">Seal Channel</button>
      </div>
    </div>
  </div>

  <script>
    const selections = {
      instinct: null,
      augment: null,
      allegiance: null
    };

    const personalityMatrix = {
      alpha: { role: 'Neon Vanguard', sigil: 'NV-07', skill: 'High-Impact Diversions', loyalty: 'Volatile', risk: 'Controlled Chaos', directive: 'Lead frontal interference squads' },
      oracle: { role: 'Circuit Oracle', sigil: 'CO-22', skill: 'Predictive Analytics', loyalty: 'Steady Pulse', risk: 'Low Exposure', directive: 'Map corp futures & exploit flux' },
      specter: { role: 'Chrome Phantom', sigil: 'CP-09', skill: 'Infiltration & Cloaking', loyalty: 'Unseen Vows', risk: 'Minimal Trace', directive: 'Ghost through surveillance nets' },
      breaker: { role: 'Data Slicer', sigil: 'DS-44', skill: 'Firewall Destruction', loyalty: 'Surge Driven', risk: 'High Voltage', directive: 'Crack corporate vaults nightly' }
    };

    const augmentInfluence = {
      'drone-swarm': { loyalty: 'Tactical Collective', risk: 'Shared Risk', directive: 'Lead drone swarms across railclouds' },
      'dream-splice': { loyalty: 'Psych Synced', risk: 'Mind Feedback', directive: 'Hijack executive dreams for intel leaks' },
      'phase-shift': { loyalty: 'Temporal Drift', risk: 'Chrono Echoes', directive: 'Phase-breach servers & vanish' }
    };

    const allegianceInfluence = {
      chaos: { loyalty: 'Entropy Surge', directive: 'Collapse the order & spark uprisings' },
      balance: { loyalty: 'Equilibrium Pact', directive: 'Stablize undercity resource flow' },
      revenge: { loyalty: 'Blood Ledger', directive: 'Exact precise retribution on boardrooms' }
    };

    let bootActive = true;
    const bootOverlay = document.getElementById('boot-overlay');
    const bootEnter = document.getElementById('boot-enter');
    const backgroundForm = document.getElementById('background-check');
    const checkAlias = document.getElementById('check-alias');
    const checkCode = document.getElementById('check-code');
    const checkStatus = document.getElementById('check-status');
    const validateAccess = document.getElementById('validate-access');
    const allegianceOptions = document.getElementById('allegiance-options');
    const checkTags = allegianceOptions.querySelectorAll('.check-tag');
    const bootLines = document.querySelectorAll('.boot-line');

    let selectedTag = null;
    let clearanceVerified = false;
    let failedAttempts = 0;

    function runBootSequence() {
      bootLines.forEach(line => {
        line.classList.remove('visible');
        const delay = parseInt(line.dataset.delay, 10);
        setTimeout(() => line.classList.add('visible'), delay);
      });
      backgroundForm.reset();
      checkTags.forEach(tag => tag.classList.remove('active'));
      selectedTag = null;
      clearanceVerified = false;
      checkStatus.textContent = '';
      validateAccess.disabled = false;
      bootEnter.style.display = 'none';
      failedAttempts = 0;
    }

    runBootSequence();

    checkTags.forEach(tag => {
      tag.addEventListener('click', () => {
        checkTags.forEach(t => t.classList.remove('active'));
        tag.classList.add('active');
        selectedTag = tag.dataset.tag;
      });
    });

    backgroundForm.addEventListener('submit', e => {
      e.preventDefault();
      const alias = checkAlias.value.trim();
      const code = checkCode.value.trim().toUpperCase();
      if (alias.length < 3) {
        checkStatus.textContent = 'Alias too faint. amplify.';
        checkStatus.style.color = '#ff6b6b';
        return;
      }
      if (!selectedTag) {
        checkStatus.textContent = 'Declare allegiance for verification.';
        checkStatus.style.color = '#ff6b6b';
        return;
      }
      if (selectedTag === 'corp') {
        checkStatus.textContent = 'Corp sympathizers flagged. access denied.';
        checkStatus.style.color = '#ff6b6b';
        return;
      }
      const clearancePhrase = 'GHOST-LINE';
      if (code !== clearancePhrase) {
        failedAttempts += 1;
        checkStatus.style.color = '#ff8c33';
        checkStatus.textContent = failedAttempts > 1 ? 'Invalid cipher. Hint: ghost-line mantra.' : 'Invalid cipher. decrypt again.';
        return;
      }
      clearanceVerified = true;
      validateAccess.disabled = true;
      checkStatus.style.color = '#3dfbff';
      checkStatus.textContent = `Identity cleared, ${alias.toUpperCase()} .`;
      bootEnter.style.display = 'inline-flex';
      bootEnter.focus();
    });

    bootEnter.addEventListener('click', () => {
      if (!clearanceVerified) return;
      bootOverlay.classList.add('hidden');
      bootActive = false;
      document.body.classList.remove('signal-fade');
      if (countdown <= 0) {
        countdown = 45;
        exitCountdown.textContent = '00:45';
        bootEnter.textContent = 'ENTER THE NEXUS';
      }
      startAmbient();
    });

    const ambientAudio = document.getElementById('ambient');
    const audioToggle = document.getElementById('audio-toggle');
    let audioLoaded = false;
    let audioOn = false;

    async function createAmbientBuffer() {
      if (!window.AudioContext) return null;
      const ctx = new AudioContext();
      const buffer = ctx.createBuffer(2, ctx.sampleRate * 20, ctx.sampleRate);
      for (let channel = 0; channel < buffer.numberOfChannels; channel++) {
        const nowBuffering = buffer.getChannelData(channel);
        for (let i = 0; i < buffer.length; i++) {
          const base = Math.sin(i / 50) * 0.2;
          const drift = Math.sin(i / 110 + channel * 0.5) * 0.1;
          const crackle = (Math.random() - 0.5) * 0.05;
          nowBuffering[i] = base + drift + crackle;
        }
      }
      const offline = new OfflineAudioContext(buffer.numberOfChannels, buffer.length, ctx.sampleRate);
      const source = offline.createBufferSource();
      source.buffer = buffer;
      const filter = offline.createBiquadFilter();
      filter.type = 'lowpass';
      filter.frequency.value = 1600;
      source.connect(filter).connect(offline.destination);
      source.start();
      const rendered = await offline.startRendering();
      const renderedCtx = new AudioContext();
      const node = renderedCtx.createBufferSource();
      node.buffer = rendered;
      const dest = renderedCtx.createMediaStreamDestination();
      node.connect(dest);
      node.start();
      const recorder = new MediaRecorder(dest.stream);
      const chunks = [];
      recorder.ondataavailable = e => chunks.push(e.data);
      recorder.start();
      setTimeout(() => recorder.stop(), 2000);
      let resolvePromise;
      const p = new Promise(resolve => resolvePromise = resolve);
      recorder.onstop = () => {
        const blob = new Blob(chunks, { type: 'audio/webm' });
        resolvePromise(blob);
      };
      return p;
    }

    function startAmbient() {
      if (audioLoaded) return;
      audioLoaded = true;

      (async () => {
        try {
          const blob = await createAmbientBuffer();
          if (!blob) return;
          const url = URL.createObjectURL(blob);
          ambientAudio.src = url;
          ambientAudio.volume = 0.45;
        } catch (err) {
          console.warn('Ambient audio unavailable', err);
        }
      })();
    }

    audioToggle.addEventListener('click', async () => {
      if (!ambientAudio.src) {
        return;
      }
      try {
        if (!audioOn) {
          await ambientAudio.play();
          audioToggle.textContent = 'AUDIO: ON';
          audioOn = true;
        } else {
          ambientAudio.pause();
          audioToggle.textContent = 'AUDIO: OFF';
          audioOn = false;
        }
      } catch (err) {
        console.warn('Audio play error', err);
      }
    });

    document.querySelectorAll('.choices').forEach(group => {
      const step = group.dataset.step;
      group.querySelectorAll('.choice-card').forEach(card => {
        card.addEventListener('click', () => {
          group.querySelectorAll('.choice-card').forEach(c => c.classList.remove('active'));
          card.classList.add('active');
          selections[step] = card.dataset.id;
        });
      });
    });

    const analyzeBtn = document.getElementById('analyze');
    const statusEl = document.getElementById('analysis-status');

    const assignmentEl = document.querySelector('.assignment');
    const badgeSigil = document.getElementById('sigil');
    const badgeText = document.getElementById('badge-text');
    const resCallsign = document.getElementById('res-callsign');
    const resSkill = document.getElementById('res-skill');
    const resLoyalty = document.getElementById('res-loyalty');
    const resRisk = document.getElementById('res-risk');
    const resDirective = document.getElementById('res-directive');

    analyzeBtn.addEventListener('click', () => {
      if (!selections.instinct || !selections.augment || !selections.allegiance) {
        statusEl.textContent = 'Select all phases to continue.';
        statusEl.style.color = '#ff6b6b';
        return;
      }
      statusEl.textContent = 'Decrypting signal...';
      statusEl.style.color = 'rgba(228,248,255,0.6)';
      analyzeBtn.disabled = true;

      setTimeout(() => {
        const base = personalityMatrix[selections.instinct];
        const augment = augmentInfluence[selections.augment];
        const allegiance = allegianceInfluence[selections.allegiance];

        const roleName = base.role;
        assignmentEl.setAttribute('data-text', roleName.toUpperCase());
        assignmentEl.textContent = roleName;
        assignmentEl.classList.add('glitch-anim');

        badgeSigil.textContent = base.sigil;
        badgeText.textContent = augment.directive;

        resCallsign.textContent = roleName.toUpperCase();
        resSkill.textContent = base.skill;

        const loyaltyBlend = `${augment.loyalty} :: ${allegiance.loyalty}`;
        resLoyalty.textContent = loyaltyBlend;

        resRisk.textContent = augment.risk;
        resDirective.textContent = allegiance.directive;

        statusEl.textContent = 'Profile sync complete. Revenant mask issued.';
        statusEl.style.color = '#3dfbff';
        analyzeBtn.disabled = false;
      }, 1800);
    });

    const uplinkForm = document.getElementById('uplink-form');
    const uplinkStatus = document.getElementById('uplink-status');

    uplinkForm.addEventListener('submit', e => {
      e.preventDefault();
      const formData = new FormData(uplinkForm);
      const alias = formData.get('name');
      const codename = formData.get('codename');
      const specialty = formData.get('specialty') || 'Unknown Vector';

      uplinkStatus.textContent = '> transmitting... ▒▒▒';
      setTimeout(() => {
        uplinkStatus.textContent = `> packet delivered. welcome, ${codename.toUpperCase()}. loyalty imprint scheduled.`;
        uplinkForm.reset();
      }, 1500);
      setTimeout(() => {
        resCallsign.textContent = codename.toUpperCase();
        resSkill.textContent = specialty;
        resRisk.textContent = 'Field Pending';
      }, 1900);
    });

    const exitCountdown = document.getElementById('exit-countdown');
    let countdown = 45;
    setInterval(() => {
      if (countdown <= 0) return;
      countdown--;
      const display = countdown.toString().padStart(2, '0');
      exitCountdown.textContent = `00:${display}`;
      if (countdown === 0) {
        document.body.classList.add('signal-fade');
        bootOverlay.classList.remove('hidden');
        bootEnter.textContent = 'RE-ENTER THE NEXUS';
        bootActive = true;
        runBootSequence();
      }
    }, 1000);

    const resetPortal = document.getElementById('reset-portal');
    resetPortal.addEventListener('click', () => {
      countdown = 45;
      exitCountdown.textContent = '00:45';
      document.body.classList.remove('signal-fade');
      bootOverlay.classList.add('hidden');
      bootEnter.textContent = 'ENTER THE NEXUS';
      bootActive = false;
      runBootSequence();
    });

    const territoryData = {
      revenant: {
        name: 'Revenant Division',
        zone: 'Sector 7G',
        specialty: 'Signal Infiltration',
        rivals: ['Chrome Syndicate'],
        description: 'Signal uplinks woven through transit spires. Revenants hijack surveillance beams and rewrite the city\'s memory nightly.'
      },
      chrome: {
        name: 'Chrome Syndicate',
        zone: 'Skyline Verge',
        specialty: 'Augment Trafficking',
        rivals: ['Revenant Division', 'Azure Wraiths'],
        description: 'Mercenary enforcers roost among chrome towers, trafficking implants and bribing drone police to mirror their will.'
      },
      azure: {
        name: 'Azure Wraiths',
        zone: 'Flooded Docklands',
        specialty: 'Ghost Logistics',
        rivals: ['Chrome Syndicate'],
        description: 'They move contraband through tidal sewers, ghosts under neon rain, decoding rival shipments before they breathe.'
      },
      wraith: {
        name: 'Helix Wraith Enclave',
        zone: 'Quantum Bazaar',
        specialty: 'Bio-Mod Black Market',
        rivals: ['Lotus Arc'],
        description: 'Bio-smiths splicing street DNA with outlaw tech. Every market deal echoes with encrypted blood oaths.'
      },
      lotus: {
        name: 'Lotus Arc Collective',
        zone: 'Underground Gardens',
        specialty: 'Psionic Espionage',
        rivals: ['Helix Wraith Enclave'],
        description: 'Cultivates psionic flora beneath rusted tram lines. Their spores seed hallucinations inside corporate think tanks.'
      }
    };

    const districtElements = document.querySelectorAll('.district');
    const territoryGang = document.getElementById('territory-gang');
    const territoryDesc = document.getElementById('territory-desc');
    const territoryZone = document.getElementById('territory-zone');
    const territorySpecialty = document.getElementById('territory-specialty');
    const territoryRivals = document.getElementById('territory-rivals');

    function renderTerritory(key) {
      const data = territoryData[key];
      if (!data) return;
      districtElements.forEach(el => el.classList.toggle('active', el.dataset.gang === key));
      territoryGang.textContent = data.name;
      territoryDesc.textContent = data.description;
      territoryZone.textContent = data.zone;
      territorySpecialty.textContent = data.specialty;
      territoryRivals.innerHTML = '';
      data.rivals.forEach(rival => {
        const span = document.createElement('span');
        span.className = 'rival-tag';
        span.textContent = rival;
        territoryRivals.appendChild(span);
      });
    }

    renderTerritory('revenant');

    districtElements.forEach(el => {
      el.addEventListener('mouseenter', () => renderTerritory(el.dataset.gang));
      el.addEventListener('focus', () => renderTerritory(el.dataset.gang));
    });

    const parallax = document.createElement('div');
    parallax.style.position = 'fixed';
    parallax.style.inset = '0';
    parallax.style.zIndex = '-1';
    parallax.style.pointerEvents = 'none';
    parallax.style.background = 'linear-gradient(130deg, rgba(255, 31, 184, 0.12), transparent 60%)';
    document.body.appendChild(parallax);

    document.addEventListener('mousemove', e => {
      const x = (e.clientX / window.innerWidth - 0.5) * 18;
      const y = (e.clientY / window.innerHeight - 0.5) * 18;
      parallax.style.transform = `translate(${x}px, ${y}px)`;
    });

    const secretModal = document.getElementById('secret-modal');
    const closeSecret = document.getElementById('close-secret');
    let secretBuffer = '';

    document.addEventListener('keydown', e => {
      if (bootActive) return;
      secretBuffer += e.key.toUpperCase();
      secretBuffer = secretBuffer.slice(-6);
      if (secretBuffer === 'GLITCH') {
        secretModal.classList.add('visible');
      }
    });

    closeSecret.addEventListener('click', () => {
      secretModal.classList.remove('visible');
      secretBuffer = '';
    });
  </script>
</body>
</html>
